<!DOCTYPE html> 
<html lang="zh-CN">
<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- ✅ SEO优化用 meta 元素 -->
  <meta name="description" content="MeFan - 提供高品质无线蓝牙耳机，带给您卓越的音频体验" />
  <meta name="keywords" content="蓝牙耳机, MeFan, 无线音频, 高品质音响, 降噪耳机" />
  <meta name="author" content="MeFan Solutions" />
  <meta name="robots" content="index, follow" />
  <!-- ✅ 结束 -->

  <title>MeFan - 让体验无线自由</title>
  <link rel="icon" href="MeFan Logo.png" type="image/x-icon"/>

  <!-- 引入字体 -->
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Poppins:wght@400;600&display=swap"
    rel="stylesheet"
  >

  <!-- 样式与脚本 -->
  <link rel="stylesheet" href="styles.css" />
  <script src="scripts.js" defer></script>
  <script src="scroll.js" defer></script>


<!-- ✅ 自动跳转脚本 -->
  <!-- 自动跳转到主站的 index.html -->
<meta http-equiv="refresh" content="0; url=https://oliverfr.com/index.html" />
<script>
  window.location.replace("https://oliverfr.com/index.html");
</script>


</head>
<body>

  <!-- 顶部：淡色背景/渐变（默认示例：浅蓝渐变） -->
  <header class="header-gradient" id="mainHeader">
    <!-- 左侧 Logo -->
    <img src="MeFan Logo.png" alt="MeFan Logo" class="logo-img" />

    <!-- 桌面端导航列表，居中对齐，带 Home / Products / About / Contact / 搜索按钮 -->
    <nav class="desktop-nav">
      <ul class="nav-list">
        <li><a href="index.html" class="active">Home</a></li>
        <li><a href="products.html">Products</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="contact.html">Contact</a></li>
        <!-- 桌面搜索图标 -->
        <li>
          <div class="search-icon" id="desktopSearchIcon">🔍</div>
        </li>
      </ul>
    </nav>

    <!-- 移动端图标区：搜索 + 汉堡菜单 -->
    <div class="mobile-icons">
      <!-- 搜索图标，与汉堡菜单相距 30px -->
      <span id="mobileSearchIcon" class="mobile-search-icon">🔍</span>

      <!-- 汉堡菜单：三条水平线，竖向堆叠，类似小号“三”字形 -->
      <div class="vertical-hamburger" id="menuIcon">
        <div class="v-bar"></div>
        <div class="v-bar"></div>
        <div class="v-bar"></div>
      </div>
    </div>

    <!-- 移动端全屏菜单 -->
    <nav id="mobileNav">
      <div class="close-btn" id="closeBtn">&times;</div>
      <ul>
      <!-- 修改为触发二级面板，增加 data-level 属性 -->
        <li><a href="javascript:void(0);" data-level="home">Home</a></li>
        <li><a href="javascript:void(0);" data-level="products">Products</a></li>
        <li><a href="javascript:void(0);" data-level="about">About</a></li>
        <li><a href="javascript:void(0);" data-level="contact">Contact</a></li>
      </ul>
    </nav>
  </header>
  
  <!-- 新增：移动端二级菜单面板（仅手机端有效） -->
  <div id="mobileNavLevel2Home" class="menu-panel menu-panel--level2">
    <div class="menu-panel__header">
      <div class="menu-panel__back">&lt; 返回</div>
      <div class="menu-panel__title">Explore the Mefan</div>
      <div class="menu-panel__close">&times;</div>
    </div>
    <div class="menu-panel__content">
      <ul>
        <li><a href="http://mefans.pages.dev" target="_blank">Explore the Mefan</a></li>
      </ul>
    </div>
  </div>

  <div id="mobileNavLevel2Products" class="menu-panel menu-panel--level2">
    <div class="menu-panel__header">
      <div class="menu-panel__back">&lt; 返回</div>
      <div class="menu-panel__title">Products</div>
      <div class="menu-panel__close">&times;</div>
    </div>
    <div class="menu-panel__content">
      <!-- 分组1：Mefan Series -->
      <div class="menu-panel__group">
        <div class="menu-panel__group-title">MEFAN SERIES</div>
        <ul class="menu-panel__group-list">
          <li><a href="product-lite.html" target="_blank">MeFan Lite</a></li>
          <li><a href="product-x1.html" target="_blank">MeFan X1</a></li>
          <li><a href="product-pro.html" target="_blank">MeFan Pro</a></li>
        </ul>
      </div>
      <!-- 分组2：Mefan Premium Series -->
      <div class="menu-panel__group">
        <div class="menu-panel__group-title">MEFAN PREMIUM SERIES</div>
        <ul class="menu-panel__group-list">
          <li><a href="example.html" target="_blank">Premium p1</a></li>
          <li><a href="example.html" target="_blank">Premium p2</a></li>
          <li><a href="example.html" target="_blank">Premium p3</a></li>
        </ul>
      </div>
      <!-- 分组3：Mefan Classic Series -->
      <div class="menu-panel__group">
        <div class="menu-panel__group-title">MEFAN CLASSIC SERIES</div>
        <ul class="menu-panel__group-list">
          <li><a href="example.html" target="_blank">Classic c1</a></li>
          <li><a href="example.html" target="_blank">Classic c2</a></li>
          <li><a href="example.html" target="_blank">Classic c3</a></li>
        </ul>
      </div>
    </div>
  </div>
   <!-- About 二级面板 -->
  <div id="mobileNavLevel2About" class="menu-panel menu-panel--level2">
    <div class="menu-panel__header">
      <div class="menu-panel__back">&lt; 返回</div>
      <div class="menu-panel__title">About</div>
      <div class="menu-panel__close">&times;</div>
    </div>
    <div class="menu-panel__content">
      <!-- 分组1：PERSONAL -->
      <div class="menu-panel__group">
        <div class="menu-panel__group-title">PERSONAL</div>
        <ul class="menu-panel__group-list">
          <li><a href="http://mefans.pages.dev" target="_blank">mefans.pages.dev</a></li>
        </ul>
      </div>
      <!-- 分组2：OPPORTUNITY & CHALLENGE -->
      <div class="menu-panel__group">
        <div class="menu-panel__group-title">OPPORTUNITY &amp; CHALLENGE</div>
        <ul class="menu-panel__group-list">
          <li><a href="http://mefans.pages.dev" target="_blank">mefans.pages.dev</a></li>
          <li><a href="example.html" target="_blank">example.html</a></li>
          <li><a href="http://mefans.pages.dev/example.html" target="_blank">example.html</a></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Contact 二级面板 -->
  <div id="mobileNavLevel2Contact" class="menu-panel menu-panel--level2">
    <div class="menu-panel__header">
      <div class="menu-panel__back">&lt; 返回</div>
      <div class="menu-panel__title">Contact</div>
      <div class="menu-panel__close">&times;</div>
    </div>
    <div class="menu-panel__content">
      <!-- 分组：CONTACT -->
      <div class="menu-panel__group">
        <div class="menu-panel__group-title">CONTACT</div>
        <ul class="menu-panel__group-list">
          <li><a href="contact.html" target="_blank">Contact us</a></li>
        </ul>
      </div>
    </div>
  </div>
 <!-- 全屏阴影层，用于点击/移动关闭大面板 -->
<div class="hover1-overlay" id="hover1Overlay"></div>

<!-- 模糊背景层 -->
<div class="blur1-bg" id="blur1Bg"></div>

<!-- 悬停面板容器（固定在导航下方） -->
<div class="hover1-content" id="hover1Content">
  <!-- 首页面板 -->
  <div class="hover1-section" id="hover1Home">
    <div class="home1-horizontal-row">
      <div class="home1-intro-col">
        <h3>Home - 特别推荐</h3>
        <p>欢迎回到首页，看看 MeFan 最新动态。</p>
      </div>
      <div class="home1-links-col">
        <ul>
          <li><a href="https://mefans.pages.dev" target="_blank" rel="noopener noreferrer">MeFan</a></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- 产品面板 -->
  <div class="hover1-section" id="hover1Products">
    <div class="products-horizontal-row">
      <div class="products-intro-col">
        <h3>Products - 产品阵列</h3>
        <p>在这里可以直接预览或跳转到各产品介绍，体验更多。</p>
        <ul>
          <li><a href="product-lite.html">MeFan Lite</a></li>
          <li><a href="product-x1.html">MeFan X1</a></li>
          <li><a href="product-pro.html">MeFan Pro</a></li>
        </ul>
      </div>
      <div class="premium1-column">
        <h4 class="premium1-title">Premium</h4>
        <ul class="premium1-list">
          <li><a href="example.html">p1</a></li>
          <li><a href="example.html">p2</a></li>
          <li><a href="example.html">p3</a></li>
        </ul>
      </div>
      <div class="classic1-column">
        <h4 class="classic1-title">Classic</h4>
        <ul class="classic1-list">
          <li><a href="example.html">c1</a></li>
          <li><a href="example.html">c2</a></li>
          <li><a href="example.html">c3</a></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- About 面板 -->
  <div class="hover1-section" id="hover1About">
    <div class="about1-horizontal-row">
      <div class="about1-intro-col">
        <h3>About - 关于我们</h3>
        <p>认识 MeFan 团队，了解我们的背景、理念与愿景。</p>
      </div>
      <div class="about1-links-col">
        <ul>
          <li><a href="about.html">About us</a></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Contact 面板 -->
  <div class="hover1-section" id="hover1Contact">
    <div class="contact1-horizontal-row">
      <div class="contact1-intro-col">
        <h3>Contact - 联系我们</h3>
        <p>问题咨询、商务合作，请在此找到联系方式。</p>
      </div>
      <div class="contact1-links-col">
        <ul>
          <li><a href="contact.html">Contact us</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>


  <!-- ===== 全屏搜索界面 ===== -->
  <div class="search-panel" id="searchPanel">
    <!-- 关闭按钮 (在手机端靠上右侧,避免文字遮挡) -->
    <span class="search-close-btn" id="searchClose">&times;</span>

    <!-- 大标题(可编辑)，同时用伪元素显示提示“🔍 Search mefans.pages.dev” -->
    <h2 class="search-title" id="searchTitle" contenteditable="true" data-placeholder="🔍 Search oliverfr.com"></h2>	

    <!-- 搜索结果列表 -->
    <div class="search-results" id="searchResults"></div>

    <!-- Quick Links 区域（固定展示） -->
    <div class="quick-links">
      <p>Quick Links</p>
      <ul>
        <li><a href="products.html">Products</a></li>
        <li><a href="about.html">About Us</a></li>
       <li><a href="https://mefans.pages.dev" target="_blank" rel="noopener noreferrer">Support</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </div>
  </div>
 <!-- 帧动画 -->
<section class="animation-container" id="animationContainer">
    <canvas id="animationCanvas"></canvas>
    <div class="overlay-content">
        <p class="banner-text">Step into nature’s serenity with MeFan.</p>

        <!-- ✅ 新增 wrapper 容器 -->
        <div class="cta1-button-wrapper">
            <!-- ✅ Explore Now 按钮 -->
            <a href="https://mefans.pages.dev" target="_blank" rel="noopener noreferrer" class="cta1-button">Explore Now</a>

            <!-- ✅ Almost Here 按钮 -->
            <a href="enjoyExperience.html" target="_blank" rel="noopener noreferrer" class="cta1-button">Almost Here</a>
        </div>
    </div>

    <button id="playPauseButton" class="play-pause">❚❚</button>
</section>

    <!-- 社交联系信息模块 -->
<div id="info1-contact-wrapper">
    <div id="info1-contact-container">
      <!-- Contact QR Code（仅悬停显示二维码） -->
      <div class="info1-contact-item">
        <img src="qr-icon.png" alt="QR Code" class="info1-icon"/>
        <!-- MODIFIED: 删除多余的 </a> 标签 -->
        <div class="info1-hover-zone"></div> <!-- 鼠标缓冲区 -->
        <span class="info1-popup">
          <img src="Mefan@Oliver F.png" alt="Contact QR" class="info1-qr"/>
        </span>
      </div>
    </div>
</div> <!-- MODIFIED: 将错误的 </section> 改为 </div> -->
<div class="natural1-carousel-container">
  <!-- 左侧切换按钮 -->
  <button class="natural1-carousel-prev">&lt;</button>

  <!-- 
    外层包裹 .natural1-carousel-track-wrapper
    不改动，保持原结构
  -->
  <div class="natural1-carousel-track-wrapper">
    <div class="natural1-carousel-track">
      
      <!-- 轮播项1 -->
      <div class="natural1-carousel-slide">
        <a href="example.html" target="_blank">
          <img src="nature1.png" alt="nature1">
        </a>
        <div class="natural1-overlay">
          <div class="natural1-button-title-group">
            <div class="natural1-bottom-row">
              <button class="natural1-explore-btn" 
                      onclick="window.open('example.html', '_blank')">
                Explore now
              </button>
              <div class="natural1-text-bottom">桌面沿用scroll.</div>
            </div>
            <div class="natural1-title">移动端Transform</div>
          </div>
        </div>
      </div>

      <!-- 轮播项2 -->
      <div class="natural1-carousel-slide">
        <a href="example.html" target="_blank">
          <img src="nature2.png" alt="nature2">
        </a>
        <div class="natural1-overlay">
          <div class="natural1-button-title-group">
            <div class="natural1-bottom-row">
              <button class="natural1-explore-btn"
                      onclick="window.open('example.html', '_blank')">
                Explore now
              </button>
              <div class="natural1-text-bottom">桌面沿用scroll.</div>
            </div>
            <div class="natural1-title">手机划快丝滑</div>
          </div>
        </div>
      </div>

      <!-- 轮播项3 -->
      <div class="natural1-carousel-slide">
        <a href="example.html" target="_blank">
          <img src="nature3.png" alt="nature3">
        </a>
        <div class="natural1-overlay">
          <div class="natural1-button-title-group">
            <div class="natural1-bottom-row">
              <button class="natural1-explore-btn"
                      onclick="window.open('example.html', '_blank')">
                Explore now
              </button>
              <div class="natural1-text-bottom">桌面沿用scroll.</div>
            </div>
            <div class="natural1-title">无偏移</div>
          </div>
        </div>
      </div>

      <!-- 轮播项4-->
      <div class="natural1-carousel-slide">
        <a href="example.html" target="_blank">
          <img src="nature4.png" 
               alt="nature4">
        </a>
        <div class="natural1-overlay">
          <div class="natural1-button-title-group">
            <div class="natural1-bottom-row">
              <button class="natural1-explore-btn"
                      onclick="window.open('example.html', '_blank')">
                Explore now
              </button>
              <div class="natural1-text-bottom">桌面沿用scroll.</div>
            </div>
            <div class="natural1-title">手机端多一帧</div>
          </div>
        </div>
      </div>

    <!-- 轮播项5 -->
      <div class="natural1-carousel-slide">
        <a href="product-lite.html" target="_blank">
          <img src="MeFan Lite.png" 
               alt="MeFan Lite">
        </a>
        <div class="natural1-overlay">
          <div class="natural1-button-title-group">
            <div class="natural1-bottom-row">
              <button class="natural1-explore-btn"
                      onclick="window.open('product-lite.html', '_blank')">
                Explore now
              </button>
              <div class="natural1-text-bottom">桌面沿用scroll.</div>
            </div>
            <div class="natural1-title">MeFan Lite</div>
          </div>
        </div>
      </div>

    <!-- 轮播项6-->
      <div class="natural1-carousel-slide">
        <a href="product-x1.html" target="_blank">
          <img src="MeFan X1.png" 
               alt="MeFan X1">
        </a>
        <div class="natural1-overlay">
          <div class="natural1-button-title-group">
            <div class="natural1-bottom-row">
              <button class="natural1-explore-btn"
                      onclick="window.open('example.htmlproduct-x1.html', '_blank')">
                Explore now
              </button>
              <div class="natural1-text-bottom">桌面沿用scroll.</div>
            </div>
            <div class="natural1-title">MeFan X1</div>
          </div>
        </div>
      </div>

    <!-- 轮播项7 -->
      <div class="natural1-carousel-slide">
        <a href="product-pro.html" target="_blank">
          <img src="MeFan Pro.png" 
               alt="MeFan Pro">
        </a>
        <div class="natural1-overlay">
          <div class="natural1-button-title-group">
            <div class="natural1-bottom-row">
              <button class="natural1-explore-btn"
                      onclick="window.open('product-pro.html', '_blank')">
                Explore now
              </button>
              <div class="natural1-text-bottom">桌面沿用scroll.</div>
            </div>
            <div class="natural1-title">Mefan Pro</div>
          </div>
        </div>
      </div>







    </div>
  </div>

  <!-- 右侧切换按钮 -->
  <button class="natural1-carousel-next">&gt;</button>
</div>

<!-- 小圆点容器 (保留不变) -->
<div class="natural1-carousel-dots-container">
  <div class="natural1-carousel-dots">
    <span class="natural1-carousel-dot"></span>
    <span class="natural1-carousel-dot"></span>
    <span class="natural1-carousel-dot"></span>
    <span class="natural1-carousel-dot"></span>
<span class="natural1-carousel-dot"></span>
    <span class="natural1-carousel-dot"></span>
    <span class="natural1-carousel-dot"></span>
  </div>
</div>

  <!-- Hero：全屏背景轮播 -->
  <section class="hero">
    <div class="hero-slides" id="hero-slides">
      <div class="hero-slide" style="background-image: url('slide1.jpg');"></div>
      <div class="hero-slide" style="background-image: url('slide2.jpg');"></div>
      <div class="hero-slide" style="background-image: url('slide3.jpg');"></div>
    </div>

    <div class="hero-dots">
      <span class="dot"></span>
      <span class="dot"></span>
      <span class="dot"></span>
    </div>

    <div class="hero-content">
      <h1>MeFan - 让体验无线自由</h1>
      <p>通过我们的无线蓝牙耳机享受无缝连接和清晰的音质。</p>
      <a href="iconic.html" class="btn">了解更多</a>
    </div>
  </section>




  <!-- Premium BT Earbuds 图片与按钮 -->
  <section class="premium-earbuds-section">
    <div class="premium-earbuds-image">
      <img src="Premium BT Earbuds.png" alt="Premium BT Earbuds" class="premium-earbuds-img" />
      <div class="premium-overlay">
        <a href="landscape.html" class="btn learn-more-btn">Learn More</a>
        <a href="touch.html" class="btn enjoy-btn">Enjoy</a>
      </div>
    </div>
  </section>

  <!-- 新插入的6张图片 -->
  <section class="image-gallery">
    <div class="image-card">
      <a href="Crystal-Clear-Lakeside.html">
        <img src="Crystal-Clear Lakeside.png" alt="Crystal Clear Lakeside"/>
        <div class="overlay">
          <p>Learn More</p>
        </div>
      </a>
    </div>
    <div class="image-card">
      <a href="Golden-Wheat-Fields.html">
        <img src="Golden Wheat Fields.png" alt="Golden Wheat Fields"/>
        <div class="overlay">
          <p>Learn More</p>
        </div>
      </a>
    </div>
    <div class="image-card">
      <a href="Scenic-Riverside-Bend.html">
        <img src="Scenic Riverside Bend.png" alt="Scenic Riverside Bend"/>
        <div class="overlay">
          <p>Learn More</p>
        </div>
      </a>
    </div>
    <div class="image-card">
      <a href="Sunset-Seaside.html">
        <img src="Sunset Seaside.png" alt="Sunset Seaside"/>
        <div class="overlay">
          <p>Learn More</p>
        </div>
      </a>
    </div>
    <div class="image-card">
      <a href="Tranquil-Mountain-Valley.html">
        <img src="Tranquil Mountain Valley.png" alt="Tranquil Mountain Valley"/>
        <div class="overlay">
          <p>Learn More</p>
        </div>
      </a>
    </div>
    <div class="image-card">
      <a href="Serene-Forest-Trail.html">
        <img src="Serene Forest Trail.png" alt="Serene Forest Trail"/>
        <div class="overlay">
          <p>Learn More</p>
        </div>
      </a>
    </div>
  </section>

<!-- 轮播容器 -->
<div class="custom-slider1">
  <div class="slider1-content">
    <div class="slider1-images">
      <div class="slider1-slide active">
        <img src="Zhang Duhu Lake.png" alt="Zhang Duhu Lake" onclick="window.open('example.html', '_blank');">
        <div class="view1-container">
          <button class="view1-btn" onclick="window.open('example.html', '_blank');">Taking in the view</button>
          <span class="view1-text">Zhang Duhu Lake</span>
        </div>
      </div>
      <div class="slider1-slide">
        <img src="Zhang Duhu Lake view.png" alt="Zhang Duhu Lake view" onclick="window.open('example.html', '_blank');">
        <div class="view1-container">
          <button class="view1-btn" onclick="window.open('example.html', '_blank');">Taking in the view</button>
          <span class="view1-text">Zhang Duhu Lake view</span>
        </div>
      </div>
      <div class="slider1-slide">
        <img src="Xinzhou Shaotanhe Lake.png" alt="Xinzhou Shaotanhe Lake" onclick="window.open('example.html', '_blank');">
        <div class="view1-container">
          <button class="view1-btn" onclick="window.open('example.html', '_blank');">Taking in the view</button>
          <span class="view1-text">Xinzhou Shaotanhe Lake</span>
        </div>
      </div>
      <div class="slider1-slide">
        <img src="Zhang Duhu wetland park.png" alt="Zhang Duhu wetland park" onclick="window.open('example.html', '_blank');">
        <div class="view1-container">
          <button class="view1-btn" onclick="window.open('example.html', '_blank');">Taking in the view</button>
          <span class="view1-text">Zhang Duhu wetland park</span>
        </div>
      </div>
      <div class="slider1-slide">
        <img src="Zhang Duhu Shuishan.png" alt="Zhang Duhu Shuishan" onclick="window.open('example.html', '_blank');">
        <div class="view1-container">
          <button class="view1-btn" onclick="window.open('example.html', '_blank');">Taking in the view</button>
          <span class="view1-text">Zhang Duhu Shuishan</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 📌 播放/暂停按钮 & 进度条 -->
<div class="slider1-controls-container">
  <!-- ✅ 播放/暂停 按钮（⚠️ 这里不加 `window.open`，避免误跳转） -->
  <button id="slider1-play-btn" class="slider1-btn playing">
    <span id="slider1-btn-icon">⏸</span> <!-- 初始状态为正在播放 -->
  </button>

  <!-- ✅ 进度条 -->
  <div class="slider1-progress">
    <div class="slider1-progress-bar"></div>
    <div class="slider1-progress-dots">
      <span class="slider1-dot active" data-index="0"></span>
      <span class="slider1-dot" data-index="1"></span>
      <span class="slider1-dot" data-index="2"></span>
      <span class="slider1-dot" data-index="3"></span>
      <span class="slider1-dot" data-index="4"></span>
    </div>
  </div>
</div>





  <!-- ✅ 3) 无限滚动优化 -->
  <section class="infinite-scroller-container">
    <div class="infinite-scroller">
      <div class="infinite-scroller-track" id="infiniteScroller">
        <div class="product-marquee-card">
          <a href="brookside.html">
            <img src="A peaceful brookside setting.png" alt="Brookside setting" />
            <div class="overlay">Explore now</div>
            <p class="text">Brookside setting</p>
          </a>
        </div>
        <div class="product-marquee-card">
          <a href="gardenia.html">
            <img src="A scenic riverside bend.png" alt="Riverside bend" />
            <div class="overlay">Explore now</div>
            <p class="text">Riverside bend</p>
          </a>
        </div>
        <div class="product-marquee-card">
          <a href="serene-coastal-shore.html">
            <img src="A serene coastal shore.png" alt="Coastal shore" />
            <div class="overlay">Explore now</div>
            <p class="text">Coastal shore</p>
          </a>
        </div>
        <div class="product-marquee-card">
          <a href="shaded-forest-path.html">
            <img src="A shaded forest path.png" alt="Forest path" />
            <div class="overlay">Explore now</div>
            <p class="text">Forest path</p>
          </a>
        </div>
      </div>

      <!-- ✅ 让按钮与滚动区域保持在一起 -->
      <div id="pauseBtn-container">
        <button id="pauseBtn"></button>
      </div>
    </div>
  </section>
<!-- ✅ 新增第一行内容 -->
    <div class="extra-line">提示:本网站中图片的命名与实际播放,实际展示的图片内容是不符的(Note: Image names on this website do not correspond to the actual displayed or played content.)</div>
  <!-- 简要介绍区 -->
  <section class="intro-section">
    <h2>为什么选择 MeFan?</h2>
    <p>我们专注于无线音频领域，融合最新技术与时尚设计，为您带来舒适与卓越的聆听体验。</p>
    <button class="btn" data-modal-target="#whyModal">更多详情</button>
  </section>

  <!-- 场景应用卡片区 -->
  <section class="use-case-section">
    <h2>应用场景</h2>
    <p>在不同场景中，MeFan耳机如何展现卓越表现？</p>

    <div class="use-case-grid">
      <!-- 运动场景 -> #sportModal -->
      <div class="use-case-item" data-modal-target="#sportModal">
        <h3>运动场景</h3>
        <p>运动时的防水、防汗表现……</p>
      </div>
      <!-- 通勤场景 -> #commuteModal -->
      <div class="use-case-item" data-modal-target="#commuteModal">
        <h3>通勤场景</h3>
        <p>地铁、公交、办公室等噪音环境表现……</p>
      </div>
      <!-- 会议场景 -> #meetingModal -->
      <div class="use-case-item" data-modal-target="#meetingModal">
        <h3>会议场景</h3>
        <p>语音通话、降噪麦克风等……</p>
      </div>
    </div>
  </section>

  <section class="value-section">
    <h2>Our Vision & Core Values</h2>
    <p>At Mefan, we’re at the very beginning of something exciting. Though our vision is still in its early stages, we believe deeply in the value of hard work, learning, and steady progress.</p>
    <p>We know the path ahead will take time and persistence. Success isn’t immediate, but it’s built step by step. We’re committed to refining our ideas, focusing on quality, and staying true to our mission of creating meaningful audio experiences.</p>
    <p>For now, we focus on laying the foundation. We aim to deliver real value to our future customers with every product we create. Your trust means a lot to us as we start this journey. The road may be long, but we’re confident that with time, this vision will take shape.</p>
  </section>

  <!-- 横线部分 -->
  <div class="divider"></div>

  <!-- 核心价值展示部分 -->
  <section class="core-values-section">
    <div class="core-value-item">
      <h3 class="dropdown">Mefan Value <span class="dropdown-arrow">&#x2304;</span></h3>
      <ul class="dropdown-content">
        <li><a href="accessibility.html">Accessibility</a></li>
      </ul>
    </div>

    <div class="core-value-item">
      <h3 class="dropdown">For Business <span class="dropdown-arrow">&#x2304;</span></h3>
      <ul class="dropdown-content">
        <li><a href="mefan-and-business.html">Mefan and Business</a></li>
      </ul>
    </div>

    <div class="core-value-item">
      <h3 class="dropdown">Entertainment <span class="dropdown-arrow">&#x2304;</span></h3>
      <ul class="dropdown-content">
        <li><a href="mefan-one.html">Mefan One</a></li>
      </ul>
    </div>
  </section>


  <!-- Social Media Icons -->
  <div class="footer-info">
    <div class="social-media">
      <a href="https://wa.me/12817839998" target="_blank" aria-label="WhatsApp">
        <img src="https://cdn-icons-png.flaticon.com/512/124/124034.png" alt="WhatsApp" class="social-icon"/>
      </a>
      <a href="https://linkedin.com/in/oliver-f-448b8a287" target="_blank" aria-label="LinkedIn">
        <img src="https://upload.wikimedia.org/wikipedia/commons/c/ca/LinkedIn_logo_initials.png" alt="LinkedIn" class="social-icon"/>
      </a>
      <a href="https://web.skype.com/?openPstnPage=true" target="_self" aria-label="Skype">
        <img src="Skype Logo.png" alt="Skype Logo" class="social-icon"/>
      </a>
      <a href="weixin://dl/chat?wxid=wxid_kesvxwp296ci12" aria-label="WeChat">
        <img src="WeChat Logo.png" alt="WeChat Logo" class="social-icon"/>
      </a>
    </div>
  </div>

  <!-- 横线部分 -->
  <div class="divider"></div>
  <div class="footer-extend">
    <p>&copy; 2025 MeFan@Oliver F. All rights reserved.</p>
  </div>

  <!-- 4个模态窗口 (去重并修正) -->
  <div class="modal" id="whyModal">
    <div class="modal-content">
      <span class="modal-close" data-modal-close>&times;</span>
      <iframe
        src="whyMeFanDetail.html"
        frameborder="0"
        class="modal-iframe">
      </iframe>
    </div>
  </div>

  <div class="modal" id="sportModal">
    <div class="modal-content">
      <span class="modal-close" data-modal-close>&times;</span>
      <iframe
        src="useCaseSport.html"
        frameborder="0"
        class="modal-iframe">
      </iframe>
    </div>
  </div>

  <div class="modal" id="commuteModal">
    <div class="modal-content">
      <span class="modal-close" data-modal-close>&times;</span>
      <iframe
        src="useCaseCommute.html"
        frameborder="0"
        class="modal-iframe">
      </iframe>
    </div>
  </div>

  <div class="modal" id="meetingModal">
    <div class="modal-content">
      <span class="modal-close" data-modal-close>&times;</span>
      <iframe
        src="useCaseMeeting.html"
        frameborder="0"
        class="modal-iframe">
      </iframe>
    </div>
  </div>
  <!-- 内联脚本：搜索逻辑与事件（原有） -->
 <!-- 其余HTML结构、CSS链接等保持不变，在 </body> 前插入以下脚本 -->
<!-- 其他 HTML 结构... -->


  <!-- 新增：回到顶部按钮 -->
  <button id="backToTop" title="Back to Top">&#8679;</button>



<script>
  /*************************************
   * 脚本A：spec1 手动左右切换轮播
   *************************************/
  (function () {
    // A1) 独立等待图片加载（仅用于 spec1 模块）
    function waitImagesLoadedSpec1(images, callback) {
      let loadedCount = 0;
      const total = images.length;
      function checkDone() {
        loadedCount++;
        if (loadedCount >= total) {
          callback();
        }
      }
      images.forEach((img) => {
        if (img.complete) {
          checkDone();
        } else {
          img.addEventListener("load", checkDone);
          img.addEventListener("error", checkDone);
        }
      });
      if (total === 0) callback();
    }

    // A2) 初始化 spec1 手动轮播（逻辑、功能与内容均保持原样）
    const initspec1ManualCarouselTrack = () => {
      const container = document.querySelector(".spec1-carousel-container");
      const track     = document.querySelector(".spec1-carousel-track");
      let slides      = Array.from(document.querySelectorAll(".spec1-carousel-slide"));
      const prevBtn   = document.querySelector(".spec1-carousel-prev");
      const nextBtn   = document.querySelector(".spec1-carousel-next");

      if (!container || !track || slides.length === 0 || !prevBtn || !nextBtn) {
        console.warn("spec1 hand-control carousel: elements or arrows not found!");
        return;
      }

      const totalReal = slides.length;
      let currentIndex = 1;
      let isAnimating  = false;
      let slideWidth   = 0;
      let gapWidth     = 15;

      // 1) 克隆首尾 => 实现无缝轮播
      const firstClone = slides[0].cloneNode(true);
      const lastClone  = slides[totalReal - 1].cloneNode(true);
      track.appendChild(firstClone);
      track.insertBefore(lastClone, track.firstChild);

      slides = Array.from(track.querySelectorAll(".spec1-carousel-slide"));

      function updateSlideWidth() {
        if (window.innerWidth <= 768) {
          const containerWidth = container.offsetWidth;
          gapWidth = containerWidth * 0.04;
          slides.forEach((slide) => {
            slide.style.width = `${containerWidth * 0.85}px`;
          });
          slideWidth = containerWidth * 0.85 + gapWidth;
        } else {
          slides.forEach((slide) => {
            slide.style.width = "";
          });
          gapWidth = 15;
          const measured = slides[1].getBoundingClientRect().width;
          slideWidth = measured + gapWidth;
        }
      }

      function updateCarousel(animated = true) {
        updateSlideWidth();
        track.style.transition = animated ? "transform 0.5s ease-in-out" : "none";

        if (window.innerWidth <= 768) {
          track.style.transform = `translateX(${-currentIndex * slideWidth + gapWidth/2}px)`;
        } else {
          track.style.transform = `translateX(${-currentIndex * slideWidth}px)`;
        }

        slides.forEach(sl => sl.classList.remove("active", "prev", "next", "shadow"));
        slides[currentIndex]?.classList.add("active");

        const nextIndex = (currentIndex + 1) % slides.length;
        const prevIndex = (currentIndex - 1 + slides.length) % slides.length;
        slides[nextIndex]?.classList.add("next");
        slides[prevIndex]?.classList.add("prev");

        slides.forEach(sl => {
          if (!sl.classList.contains("active")) {
            sl.classList.add("shadow");
          }
        });

        slides.forEach((slide) => {
          const link = slide.querySelector("a");
          if (link) {
            link.style.pointerEvents = slide.classList.contains("active") ? "auto" : "none";
          }
        });
      }

      function nextSlide() {
        if (isAnimating) return;
        isAnimating = true;
        currentIndex++;
        updateCarousel(true);
        setTimeout(() => {
          if (currentIndex === slides.length - 1) {
            track.style.transition = "none";
            currentIndex = 1;
            updateCarousel(false);
          }
          isAnimating = false;
        }, 500);
      }
      function prevSlide() {
        if (isAnimating) return;
        isAnimating = true;
        currentIndex--;
        updateCarousel(true);
        setTimeout(() => {
          if (currentIndex === 0) {
            track.style.transition = "none";
            currentIndex = slides.length - 2;
            updateCarousel(false);
          }
          isAnimating = false;
        }, 500);
      }

      prevBtn.addEventListener("click", () => {
        if (!isAnimating) prevSlide();
      });
      nextBtn.addEventListener("click", () => {
        if (!isAnimating) nextSlide();
      });

      slides.forEach((slide) => {
        slide.addEventListener("click", (e) => {
          if (slide.classList.contains("active")) {
            // 当前 slide 被点击时不作处理
          } else if (slide.classList.contains("next")) {
            e.preventDefault();
            if (!isAnimating) nextSlide();
          } else if (slide.classList.contains("prev")) {
            e.preventDefault();
            if (!isAnimating) prevSlide();
          }
        });
        const exploreBtn = slide.querySelector(".spec1-explore-btn");
        if (exploreBtn) {
          exploreBtn.addEventListener("click", (ev) => {
            ev.stopPropagation();
          });
        }
      });

      let startX = 0;
      let isSwiping = false;
      track.addEventListener("touchstart", (e) => {
        if (e.touches.length === 1 && !isAnimating) {
          startX = e.touches[0].clientX;
          isSwiping = true;
        }
      }, { passive: true });
      track.addEventListener("touchmove", () => {}, { passive: true });
      track.addEventListener("touchend", (e) => {
        if (!isSwiping) return;
        isSwiping = false;
        const endX = e.changedTouches[0].clientX;
        const distance = endX - startX;
        if (Math.abs(distance) > 20) {
          if (distance < 0) nextSlide();
          else prevSlide();
        }
      }, { passive: true });

      function onResize() {
        isAnimating = false;
        track.style.transition = "none";
        updateCarousel(false);
        setTimeout(() => {
          track.style.transition = "transform 0.5s ease-in-out";
        }, 50);
      }
      window.addEventListener("resize", onResize);

      track.style.transition = "none";
      updateCarousel(false);
      setTimeout(() => {
        track.style.transition = "transform 0.5s ease-in-out";
      }, 50);

      prevBtn.style.display = "block";
      nextBtn.style.display = "block";
    };

    // A3) 确保所有图片加载完成后再初始化轮播
    window.addEventListener('load', () => {
      const spec1Imgs = document.querySelectorAll(".spec1-carousel-slide img");
      if (spec1Imgs.length > 0) {
        waitImagesLoadedSpec1(spec1Imgs, () => {
          initspec1ManualCarouselTrack();
        });
      }
    });
  })();

  /***************************************************
   * 脚本B：natural1 轮播 (桌面端 scroll-snap / 移动端 transform)
   ***************************************************/
 
(function(){
  // ============== 1) 获取容器 & 等图加载 ==============
  const container = document.querySelector(".natural1-carousel-container");
  if (!container) return;

  container.style.visibility = "hidden"; // 初始隐藏

  const allImgs = Array.from(document.querySelectorAll(".natural1-carousel-slide img"));
  waitImagesLoadedNatural1(allImgs, () => {
    if (!container) return;
    const isMobile = window.innerWidth <= 768;
    if(isMobile){
      initSnapCarouselMobileApple();  // 移动端 => 不变
    } else {
      initSnapCarouselDesktopWithObserver(); // 桌面端 => 新逻辑(到可视区才启动)
    }
    container.style.visibility = "visible";
  });

  // ============== 2) 等图片加载函数 (保持原先) ==============
  function waitImagesLoadedNatural1(images, callback) {
    let loaded=0;
    const total= images.length;
    if(!total){
      callback();
      return;
    }
    images.forEach(img=>{
      if(img.complete){
        check();
      } else {
        img.addEventListener("load", check);
        img.addEventListener("error", check);
      }
    });
    function check(){
      loaded++;
      if(loaded>= total){
        callback();
      }
    }
  }

  // ============== 3) 移动端 => 三套 + transform + ... ==============
function initSnapCarouselMobileApple() {
  console.log("[natural1] Mobile => triple-set + transform + toFixed(3) + infinite.");

  const track = document.querySelector(".natural1-carousel-track");
  const container = document.querySelector(".natural1-carousel-container");
  let slides = Array.from(track.querySelectorAll(".natural1-carousel-slide"));

  const prevBtn = document.querySelector(".natural1-carousel-prev");
  const nextBtn = document.querySelector(".natural1-carousel-next");
  const dots = Array.from(document.querySelectorAll(".natural1-carousel-dot"));

  if (!track || !container || slides.length === 0) return;

  // 1) 复制三倍
  const original = slides.slice();
  const totalReal = original.length;
  track.innerHTML = "";
  // 第一套
  original.forEach(sl => track.appendChild(sl.cloneNode(true)));
  // 中间套
  original.forEach(sl => track.appendChild(sl.cloneNode(true)));
  // 第三套
  original.forEach(sl => track.appendChild(sl.cloneNode(true)));
  slides = Array.from(track.querySelectorAll(".natural1-carousel-slide"));
  const totalSlides = slides.length; // = 3 * totalReal

  // 2) 计算 “单张+gap= pitch”
  let containerW = 0, pitch = 0;
  function updateSizes() {
    containerW = container.offsetWidth;
    if (slides.length >= 2) {
      const left1 = slides[0].getBoundingClientRect().left;
      const left2 = slides[1].getBoundingClientRect().left;
      let raw = left2 - left1;
      pitch = parseFloat(raw.toFixed(3));
    } else if (slides[0]) {
      pitch = slides[0].offsetWidth + 15;
    }
  }
  updateSizes();

  let currentIndex = totalReal; // 中间套起始
  let currentTranslate = 0;
  const TRANSITION_TIME = 600;

  function setTrackPos(value, withTrans = true) {
    track.style.transition = withTrans
      ? "transform 0.6s cubic-bezier(0.22,1,0.36,1)"
      : "none";
    track.style.transform = `translateX(${value}px)`;
    currentTranslate = value;
  }

  // offset = (containerW - (pitch - 15)) / 2, transform = -(index * pitch) + offset
  function getTargetTranslate(idx) {
    let realW = parseFloat((pitch - 15).toFixed(3));
    let offset = (containerW - realW) / 2;
    offset = parseFloat(offset.toFixed(3));
    let val = -(idx * pitch) + offset;
    return parseFloat(val.toFixed(3));
  }

  function goToIndex(i, anim = true) {
    currentIndex = i;
    let target = getTargetTranslate(i);
    setTrackPos(target, anim);
    updateClasses();
  }

  function getActiveIndexByTranslate() {
    let realW = pitch - 15;
    let offset = (containerW - realW) / 2;
    let approximate = -(currentTranslate - offset) / pitch;
    return Math.round(approximate);
  }
  function mapToRealIndex(i) {
    return i % totalReal;
  }

  function updateClasses() {
    const actI = getActiveIndexByTranslate();
    slides.forEach(s => s.classList.remove("active", "prev", "next", "shadow"));

    if (slides[actI]) slides[actI].classList.add("active");
    const nextI = (actI + 1) % totalSlides;
    const prevI = (actI - 1 + totalSlides) % totalSlides;
    slides[nextI]?.classList.add("next");
    slides[prevI]?.classList.add("prev");

    slides.forEach(s => {
      if (!s.classList.contains("active")) s.classList.add("shadow");
    });

    const dotI = mapToRealIndex(actI);
    dots.forEach((d, i) => {
      d.classList.toggle("active", i === dotI);
    });
  }

  // fixCloneIndex => 防止末张闪白
  function fixCloneIndex() {
    const actI = getActiveIndexByTranslate();
    if (actI <= 1) {
      currentIndex = actI + totalReal;
      setTrackPos(getTargetTranslate(currentIndex), false);
    } else if (actI >= (2 * totalReal - 1)) {
      currentIndex = (actI - 2 * totalReal) + totalReal;
      setTrackPos(getTargetTranslate(currentIndex), false);
    } else {
      currentIndex = actI;
    }
    updateClasses();
    resetAutoTimer();
  }

  function nextSlide() {
    currentIndex++;
    goToIndex(currentIndex, true);
    setTimeout(() => fixCloneIndex(), TRANSITION_TIME);
    resetAutoTimer();
  }
  function prevSlide() {
    currentIndex--;
    goToIndex(currentIndex, true);
    setTimeout(() => fixCloneIndex(), TRANSITION_TIME);
    resetAutoTimer();
  }

  // 自动轮播
  let autoTimer = setInterval(nextSlide, 5000);
  function resetAutoTimer() {
    clearInterval(autoTimer);
    autoTimer = setInterval(nextSlide, 5000);
  }

  // 左右切换按钮
  prevBtn?.addEventListener("click", (e) => {
    e.stopPropagation();
    prevSlide();
  });
  nextBtn?.addEventListener("click", (e) => {
    e.stopPropagation();
    nextSlide();
  });

  // dots 点击
  dots.forEach((dot, i) => {
    dot.addEventListener("click", (e) => {
      e.stopPropagation();
      currentIndex = i + totalReal;
      goToIndex(currentIndex, true);
      setTimeout(() => fixCloneIndex(), TRANSITION_TIME);
      resetAutoTimer();
    });
  });

  // slide 点击
  slides.forEach(sl => {
    sl.addEventListener("click", (e) => {
      if (sl.classList.contains("active")) {
        // do nothing
      } else if (sl.classList.contains("next")) {
        e.preventDefault();
        nextSlide();
      } else if (sl.classList.contains("prev")) {
        e.preventDefault();
        prevSlide();
      }
    });
    const exploreBtn = sl.querySelector(".natural1-explore-btn");
    if (exploreBtn) {
      exploreBtn.addEventListener("click", (ev) => {
        ev.stopPropagation();
      });
    }
  });

  // ========================== 新增: 用户上下滑检测 ==========================
  let startX = 0,
    startY = 0,
    isDragging = false,
    isVerticalScrolling = false,  // 标记纵向滚动
    dragStart = 0,
    startTime = 0;

  track.style.transition = "none";

  // 触摸开始
  track.addEventListener("touchstart", (e) => {
    if (e.touches.length === 1) {
      isDragging = true;
      isVerticalScrolling = false; // 每次触发新的 touchstart，都重置
      track.style.transition = "none";

      startX = e.touches[0].clientX;
      startY = e.touches[0].clientY;
      dragStart = currentTranslate;
      startTime = Date.now();
    }
  }, { passive: false });

  // 触摸移动
  track.addEventListener("touchmove", (e) => {
    if (!isDragging) return;

    const currentX = e.touches[0].clientX;
    const currentY = e.touches[0].clientY;
    const diffX = currentX - startX;
    const diffY = currentY - startY;

    // 如果已经判定纵向滚动，则让浏览器自己处理上下滚动，不做左右拖拽
    if (isVerticalScrolling) {
      return;
    }

    // 如果还没判定方向，则做一次方向判断
    const absX = Math.abs(diffX);
    const absY = Math.abs(diffY);
    // 设置一个小阈值，比如10
    if (absY > absX && absY > 10) {
      // 说明用户主要在上下滑 -> 放弃轮播拖拽
      isVerticalScrolling = true;
      isDragging = false; 
      return;
    }

    // 若横向为主 -> 阻止默认滚动，让轮播跟随手指左右拖拽
    e.preventDefault();
    track.style.transform = `translateX(${dragStart + diffX}px)`;
    currentTranslate = dragStart + diffX;
  }, { passive: false });

  // 触摸结束
  track.addEventListener("touchend", (e) => {
    if (!isDragging) return;
    isDragging = false;

    // 如果已判定是纵向滚动，就不执行轮播切换
    if (isVerticalScrolling) {
      return;
    }

    track.style.transition = "transform 0.6s cubic-bezier(0.22,1,0.36,1)";
    const dist = e.changedTouches[0].clientX - startX;
    const elapsed = Date.now() - startTime;
    const speed = dist / elapsed;

    if (Math.abs(dist) > 10) {
      if (speed < -0.5) {
        nextSlide();
        return;
      } else if (speed > 0.5) {
        prevSlide();
        return;
      }
      if (dist < 0) {
        nextSlide();
      } else {
        prevSlide();
      }
    } else {
      // 如果滑动很小，就回到当前
      goToIndex(currentIndex, true);
      setTimeout(() => fixCloneIndex(), TRANSITION_TIME);
      resetAutoTimer();
    }
  }, { passive: false });

  // 窗口尺寸变化
  window.addEventListener("resize", () => {
    updateSizes();
    let val = getTargetTranslate(currentIndex);
    setTrackPos(val, false);
    fixCloneIndex();
  });

  function init() {
    updateSizes();
    let val = getTargetTranslate(currentIndex);
    setTrackPos(val, false);
    updateClasses();
  }
  init();
}



  // ============== 4) 桌面端 => 首尾克隆 + scroll-snap + 到可视区才启动 ==============
 function initSnapCarouselDesktopWithObserver(){
  console.log("[natural1-desktop] scroll-snap + clone + no jump + intersectionObserver start.");

  const container = document.querySelector(".natural1-carousel-container");
  const track     = container.querySelector(".natural1-carousel-track");
  let slides      = Array.from(track.querySelectorAll(".natural1-carousel-slide"));
  if(!slides.length){
    console.warn("[natural1-desktop] no slides found!");
    return;
  }

  const prevBtn = document.querySelector(".natural1-carousel-prev");
  const nextBtn = document.querySelector(".natural1-carousel-next");
  const dots    = Array.from(document.querySelectorAll(".natural1-carousel-dot"));

  // A) 首尾克隆
  const totalReal= slides.length;
  const firstClone= slides[0].cloneNode(true);
  const lastClone = slides[slides.length-1].cloneNode(true);
  track.appendChild(firstClone);
  track.insertBefore(lastClone, slides[0]);
  slides= Array.from(track.querySelectorAll(".natural1-carousel-slide"));

  // B) 当前索引=1 => 第一张真实
  let currentIndex= 1;
  let scrollTimer= null;
  let autoTimer= null; // 自动播放定时器

  // C) scroll-snap
  container.style.overflowX      = "auto";
  container.style.scrollSnapType = "x mandatory";
  container.style.scrollBehavior = "smooth";

  slides.forEach(sl=>{
    sl.style.scrollSnapAlign= "center";
    // 其他 CSS 视需
  });

  // D) setInitialPos => 若在视口则滚到 index=1
  function setInitialPos(){
    if(isInViewport(container)){
      track.style.scrollBehavior="auto";
      slides[1].scrollIntoView({ behavior:"auto", block:"nearest", inline:"center"});
      track.style.scrollBehavior="smooth";
    }
  }
  setInitialPos();

  // E) 找到最活跃slide => 距容器中心最近
  function getActiveIndex(){
    const cRect= container.getBoundingClientRect();
    const cCenter= cRect.left + cRect.width/2;
    let minDiff= Infinity, foundI=1;
    slides.forEach((sl,i)=>{
      const r= sl.getBoundingClientRect();
      const sCenter= r.left + r.width/2;
      const diff= Math.abs(sCenter- cCenter);
      if(diff< minDiff){
        minDiff= diff;
        foundI= i;
      }
    });
    return foundI;
  }

  // F) updateClasses => active, next, prev, dots
  function updateClasses(){
    const actI= getActiveIndex();
    slides.forEach(s=> s.classList.remove("active","prev","next","shadow"));
    slides[actI]?.classList.add("active");
    const nextI= (actI+1)%slides.length;
    const prevI= (actI-1+ slides.length)% slides.length;
    slides[nextI]?.classList.add("next");
    slides[prevI]?.classList.add("prev");
    slides.forEach(s=>{
      if(!s.classList.contains("active")){
        s.classList.add("shadow");
      }
    });
    // dots => 0 => totalReal-1, last => 0
    let dotIndex;
    if(actI===0){
      dotIndex= totalReal-1;
    } else if(actI=== slides.length-1){
      dotIndex=0;
    } else {
      dotIndex= actI-1;
    }
    dots.forEach((d,i)=>{
      d.classList.toggle("active", i=== dotIndex);
    });
  }

  // G) fixCloneIndex => 若 actI=0 => 跳到 totalReal, actI=slides.length-1 => 跳到1
  function fixCloneIndex(){
    const actI= getActiveIndex();
    if(actI===0){
      if(isInViewport(container)){
        currentIndex= totalReal;
        track.style.scrollBehavior="auto";
        slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center"});
        track.style.scrollBehavior="smooth";
      } else {
        currentIndex= totalReal;
      }
    } else if(actI=== slides.length-1){
      if(isInViewport(container)){
        currentIndex=1;
        track.style.scrollBehavior="auto";
        slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center"});
        track.style.scrollBehavior="smooth";
      } else {
        currentIndex=1;
      }
    } else {
      currentIndex= actI;
    }
    updateClasses();
  }

  // H) scroll => 防抖 => fixCloneIndex
  track.addEventListener("scroll",()=>{
    if(scrollTimer) clearTimeout(scrollTimer);
    scrollTimer= setTimeout(()=>{
      fixCloneIndex();
      updateClasses();
    },150);
  });

  // I) autoTimer => only +1 => no skip
  let autoplayInterval= 5000;

  function nextSlide(){
    if(!isInViewport(container)){
      stopAutoTimer();
      return;
    }
    if(currentIndex=== slides.length-2){
      // 到最后真实 => 回到1
      track.style.scrollBehavior="auto";
      currentIndex=1;
      slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center"});
      track.style.scrollBehavior="smooth";
    } else {
      currentIndex++;
      scrollToIndex(currentIndex,true);
    }
  }
  function prevSlide(){
    if(!isInViewport(container)){
      stopAutoTimer();
      return;
    }
    if(currentIndex===1){
      track.style.scrollBehavior="auto";
      currentIndex= totalReal;
      slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center"});
      track.style.scrollBehavior="smooth";
    } else {
      currentIndex--;
      scrollToIndex(currentIndex,true);
    }
  }
  function scrollToIndex(i, smooth=true){
    if(i<0) i=0;
    if(i>= slides.length) i= slides.length-1;
    const target= slides[i];
    if(!target) return;
    if(isInViewport(container)){
      track.style.scrollBehavior= smooth?"smooth":"auto";
      target.scrollIntoView({
        behavior: smooth?"smooth":"auto",
        block:"nearest",
        inline:"center"
      });
    } else {
      currentIndex= i;
    }
  }
  function stopAutoTimer(){
    clearInterval(autoTimer);
    autoTimer= null;
  }
  function startAutoTimer(){
    if(!autoTimer){
      autoTimer= setInterval(nextSlide, autoplayInterval);
    }
  }
  function resetAutoTimer(){
    stopAutoTimer();
    startAutoTimer();
  }

  // J) 按钮 / dots
  prevBtn?.addEventListener("click",(e)=>{
    e.stopPropagation();
    prevSlide();
    resetAutoTimer();
  });
  nextBtn?.addEventListener("click",(e)=>{
    e.stopPropagation();
    nextSlide();
    resetAutoTimer();
  });
  dots.forEach((dot,i)=>{
    dot.addEventListener("click",(e)=>{
      e.stopPropagation();
      currentIndex= i+1;
      scrollToIndex(currentIndex,true);
      resetAutoTimer();
    });
  });
  slides.forEach((slide)=>{
    slide.addEventListener("click",(e)=>{
      if(slide.classList.contains("active")){
        // do nothing
      } else if(slide.classList.contains("next")){
        e.preventDefault();
        nextSlide();
        resetAutoTimer();
      } else if(slide.classList.contains("prev")){
        e.preventDefault();
        prevSlide();
        resetAutoTimer();
      }
    });
    const exploreBtn= slide.querySelector(".natural1-explore-btn");
    if(exploreBtn){
      exploreBtn.addEventListener("click",(ev)=> ev.stopPropagation());
    }
  });

  // K) visibilitychange/pageshow => 不跳页
  document.addEventListener("visibilitychange", handleVisibilityChange);
  window.addEventListener("pageshow", handlePageShow);

  function handleVisibilityChange(){
    if(!document.hidden){
      // 回到前台 => 若 autoTimer为空 && 容器在 viewport 中 => start
      // ★ 新增：如果此时 natural1 也“居中或附近”，亦可执行 startAutoTimer
      if(!autoTimer){
        // 1) 自带条件：只要有一部分在可视区就开始
        if(isInViewport(container)){
          startAutoTimer();
        }
        // 2) 如果想更严格，让“在可视区” + “正好在页面中心”才恢复：
        // if(isCenteredInViewport(container)){
        //   startAutoTimer();
        // }
      }
      // 修正克隆并自动滚回之前的位置
      fixCloneIndex();
      track.style.scrollBehavior="auto";
      slides[currentIndex].scrollIntoView({ behavior:"auto", block:"nearest", inline:"center"});
      track.style.scrollBehavior="smooth";
    } else {
      // 离开 => stop
      stopAutoTimer();
    }
  }

  function handlePageShow(e){
    if(e.persisted){
      // bfcache
      fixCloneIndex();
      track.style.scrollBehavior="auto";
      slides[currentIndex].scrollIntoView({ behavior:"auto", block:"nearest", inline:"center"});
      track.style.scrollBehavior="smooth";
    }
  }

  // L) IntersectionObserver => 当用户划到 natural1 区域 => start auto
  const observer = new IntersectionObserver((entries)=>{
    entries.forEach(entry=>{
      if(entry.isIntersecting){
        startAutoTimer();
      } else {
        stopAutoTimer();
      }
    });
  }, { threshold: 0.1 }); 
  observer.observe(container);

  // M) 初始化
  function init(){
    track.style.scrollBehavior="auto";
    scrollToIndex(currentIndex,false);
    track.style.scrollBehavior="smooth";
    updateClasses();
  }
  init();

  window.addEventListener("resize", ()=>{
    fixCloneIndex();
    updateClasses();
  });

}

/** ============== 工具函数: isInViewport ============== **/
function isInViewport(elem){
  if(!elem) return false;
  const rect= elem.getBoundingClientRect();
  return (rect.top< window.innerHeight && rect.bottom>=0);
}

/**
 * ============== 新增示例函数: isCenteredInViewport ==============
 * 如果你想更精准地判断 natural1 轮播区是否“恰好”居中或在中心附近，
 * 可以定义一个阈值，比如距离浏览器垂直中线 100px 以内算是“在中心”。
 * 具体可以根据业务需要自由调整。
 */
function isCenteredInViewport(elem){
  if(!elem) return false;
  const rect = elem.getBoundingClientRect();
  const windowHeight = window.innerHeight;
  // 计算容器的垂直中点
  const containerCenter = rect.top + rect.height / 2;
  // 浏览器视口中点
  const viewportCenter  = windowHeight / 2;
  // 阈值，比如上下 100 像素都认为在中心区域
  const threshold = 100; 
  return Math.abs(containerCenter - viewportCenter) <= threshold;
}

})();


  /***********************
   * 脚本C：搜索逻辑
   ***********************/
  (function(){
    const body          = document.body;
    const mainHeader    = document.getElementById('mainHeader');
    const desktopSearch = document.getElementById('desktopSearchIcon');
    const mobileSearch  = document.getElementById('mobileSearchIcon');
    const searchPanel   = document.getElementById('searchPanel');
    const searchClose   = document.getElementById('searchClose');
    const searchTitle   = document.getElementById('searchTitle');
    const searchResults = document.getElementById('searchResults');

    // 模拟本网站可搜索内容 (示例)
    const siteContents = [
      { text: "About MeFan", url: "about.html" },
      { text: "MeFan Lite - Wireless Earbuds", url: "product-lite.html" },
      { text: "MeFan X1 - Noise Canceling Headphones", url: "product-x1.html" },
      { text: "MeFan Pro - Premium Audio", url: "product-pro.html" },
      { text: "Earbud Tips & Support", url: "support.html" },
      { text: "Contact Us", url: "contact.html" },
      { text: "Products Overview", url: "products.html" }
    ];

    function openSearch() {
      body.classList.add('search-open');
      searchTitle.textContent = "";
      searchResults.innerHTML = "";
    }
    function closeSearch() {
      body.classList.remove('search-open');
    }

    if (desktopSearch) desktopSearch.addEventListener('click', openSearch);
    if (mobileSearch)  mobileSearch.addEventListener('click', openSearch);
    if (searchClose)   searchClose.addEventListener('click', closeSearch);

    document.addEventListener('keydown', function(e){
      if (e.key === "Escape") {
        closeSearch();
      }
    });

    document.addEventListener('click', function(e){
      // 若点击在 searchPanel 外部，且不是搜索图标，就关闭
      if (!searchPanel.contains(e.target)
          && e.target !== desktopSearch
          && e.target !== mobileSearch) {
        closeSearch();
      }
    });

    // 当用户输入时，动态生成搜索结果
    if (searchTitle && searchResults) {
      searchTitle.addEventListener('input', function(){
        const query = searchTitle.innerText.trim().toLowerCase();
        if (!query) {
          searchResults.innerHTML = "";
          return;
        }
        const matched = siteContents.filter(item =>
          item.text.toLowerCase().includes(query)
        );
        searchResults.innerHTML = "";
        if (matched.length > 0) {
          matched.forEach(obj => {
            const div = document.createElement('div');
            div.classList.add('search-item');
            // 用 <a> 链接实现真实跳转
            const link = document.createElement('a');
            link.href = obj.url;
            link.textContent = obj.text;
            link.style.textDecoration = "none";
            link.style.color = "#333";
            link.target = "_self";
            div.appendChild(link);
            searchResults.appendChild(div);
          });
        } else {
          const noRes = document.createElement('div');
          noRes.classList.add('no-result');
          noRes.textContent = "Sorry, no results found.";
          searchResults.appendChild(noRes);
        }
      });
    }
  })();


  /************************************
   * 脚本D：移动端菜单逻辑 (基础)
   ************************************/
  (function () {
    const menuIcon  = document.getElementById('menuIcon');
    const closeBtn  = document.getElementById('closeBtn');
    const mobileNav = document.getElementById('mobileNav');

    if (menuIcon && closeBtn && mobileNav) {
      menuIcon.addEventListener('click', () => {
        mobileNav.classList.add('active');
      });
      closeBtn.addEventListener('click', () => {
        mobileNav.classList.remove('active');
      });
      document.querySelectorAll('#mobileNav ul li a').forEach(link => {
        link.addEventListener('click', () => {
          // 点击任意链接后关闭菜单
          mobileNav.classList.remove('active');
        });
      });
    }
  })();


  /***************************************
   * 脚本E：核心价值下拉箭头
   ***************************************/
  (function () {
    document.querySelectorAll(".core-value-item h3").forEach(item => {
      item.addEventListener("click", function () {
        let content = this.nextElementSibling;
        let arrow   = this.querySelector(".dropdown-arrow");
        // 切换当前点击项的展开/收起
        if (content.style.display === "block") {
          content.style.display = "none";
          arrow.textContent = "\u2304"; // 下箭头
          this.classList.remove("active");
        } else {
          content.style.display = "block";
          arrow.textContent = "\u2303"; // 上箭头
          this.classList.add("active");
        }
        // 关闭其他已展开的下拉项
        document.querySelectorAll(".core-value-item.active").forEach(other => {
          if (other !== this) {
            other.querySelector("ul").style.display = "none";
            let otherArrow = other.querySelector(".dropdown-arrow");
            if (otherArrow) {
              otherArrow.textContent = "\u2304"; // 下箭头
            }
            other.classList.remove("active");
          }
        });
      });
    });
  })();


  /***************************************
   * 脚本F：社交媒体 & 帧动画
   ***************************************/
  (function () {
    if (typeof initFrameAnimation === "function") {
      initFrameAnimation();
    }
    initContactButtons();
    function initContactButtons() {
      const playPauseButton  = document.getElementById("playPauseButton");
      const contactContainer = document.getElementById("info1-contact-container");

      if (!playPauseButton || !contactContainer) {
        console.warn("❌ playPauseButton 或 info1-contact-container 未找到！");
        return;
      }

      function updateContactPosition() {
        const buttonRect = playPauseButton.getBoundingClientRect();
        contactContainer.style.top   = `${buttonRect.bottom + 12}px`;
        contactContainer.style.right = `${window.innerWidth - buttonRect.right}px`;
      }

      window.addEventListener("resize", updateContactPosition);

      new MutationObserver(updateContactPosition).observe(playPauseButton, { 
        attributes: true, 
        childList: true, 
        subtree: true 
      });

      updateContactPosition();
    }
  })();


  /*****************************************
   * 脚本G：桌面导航栏悬停 (Desktop Nav Hover)
   *****************************************/
  (function(){
    const header         = document.getElementById('mainHeader');
    const navLinks       = document.querySelectorAll('.desktop-nav .nav-list > li > a');
    const hoverOverlay   = document.getElementById('hover1Overlay');
    const hoverContent   = document.getElementById('hover1Content');
    const blurBg         = document.getElementById('blur1Bg'); // 模糊背景层

    const sectionsMap = {
      'Home':     document.getElementById('hover1Home'),
      'Products': document.getElementById('hover1Products'),
      'About':    document.getElementById('hover1About'),
      'Contact':  document.getElementById('hover1Contact')
    };

    function hideAllSections() {
      Object.values(sectionsMap).forEach(sec => sec && sec.classList.remove('active'));
    }

    function showHover() {
      hoverOverlay.classList.add('active');
      hoverContent.classList.add('active');
      header.classList.add('nav-white'); // 导航变白
      if (blurBg) blurBg.classList.add('active'); // 显示模糊背景
    }

    function hideHover() {
      hoverOverlay.classList.remove('active');
      hoverContent.classList.remove('active');
      header.classList.remove('nav-white');
      if (blurBg) blurBg.classList.remove('active'); // 隐藏模糊背景
      hideAllSections();
    }

    // 鼠标移到导航链接 => 显示对应悬停面板
    navLinks.forEach(link => {
      link.addEventListener('mouseenter', () => {
        const text = link.textContent.trim();
        hideAllSections();
        if (sectionsMap[text]) {
          sectionsMap[text].classList.add('active');
          showHover();
        } else {
          hideHover();
        }
      });
    });

    // 鼠标离开悬停面板 => 关闭
    hoverContent.addEventListener('mouseleave', () => {
      hideHover();
    });

    // 鼠标移动到遮罩层 => 关闭
    hoverOverlay.addEventListener('mousemove', () => {
      hideHover();
    });

    // 鼠标离开模糊背景层 => 关闭
    if (blurBg) {
      blurBg.addEventListener('mousemove', () => {
        hideHover();
      });
    }
  })();


  /**********************************************
   * 脚本H：移动端多级菜单 (若需要)
   **********************************************/
  (function(){
    const mobileNav     = document.getElementById('mobileNav');
    const homePanel     = document.getElementById('mobileNavLevel2Home');
    const productsPanel = document.getElementById('mobileNavLevel2Products');
    const aboutPanel    = document.getElementById('mobileNavLevel2About');
    const contactPanel  = document.getElementById('mobileNavLevel2Contact');

    // 若这些面板不存在，就跳过
    if (!mobileNav || !homePanel || !productsPanel || !aboutPanel || !contactPanel) {
      console.log("多级菜单面板未找到，若不需要此功能可删除本脚本。");
      return;
    }

    function showSubPanel(panel){
      mobileNav.classList.remove('active');
      homePanel.classList.remove('active');
      productsPanel.classList.remove('active');
      aboutPanel.classList.remove('active');
      contactPanel.classList.remove('active');
      panel.classList.add('active');
    }
    function showMainNav(){
      homePanel.classList.remove('active');
      productsPanel.classList.remove('active');
      aboutPanel.classList.remove('active');
      contactPanel.classList.remove('active');
      mobileNav.classList.add('active');
    }
    const navLinks = mobileNav.querySelectorAll('ul li a');
    navLinks.forEach(link => {
      const level = link.getAttribute('data-level');
      if(level === 'home'){
        link.addEventListener('click', function(e){
          e.preventDefault();
          showSubPanel(homePanel);
        });
      } else if(level === 'products'){
        link.addEventListener('click', function(e){
          e.preventDefault();
          showSubPanel(productsPanel);
        });
      } else if(level === 'about'){
        link.addEventListener('click', function(e){
          e.preventDefault();
          showSubPanel(aboutPanel);
        });
      } else if(level === 'contact'){
        link.addEventListener('click', function(e){
          e.preventDefault();
          showSubPanel(contactPanel);
        });
      }
    });
    const backButtons = document.querySelectorAll('.menu-panel__back');
    backButtons.forEach(btn => {
      btn.addEventListener('click', function(e){
        e.preventDefault();
        showMainNav();
      });
    });
    const subCloseButtons = document.querySelectorAll('.menu-panel__close');
    subCloseButtons.forEach(btn => {
      btn.addEventListener('click', function(e){
        e.preventDefault();
        mobileNav.classList.remove('active');
        homePanel.classList.remove('active');
        productsPanel.classList.remove('active');
        aboutPanel.classList.remove('active');
        contactPanel.classList.remove('active');
      });
    });
  })();
<!-- 建议在底部或使用 <defer> -->
  /************************************
   * 脚本I：demo1 轮播 (含局部 waitImagesLoaded)
   ************************************/
  (function () {
    // I1) 等待图片加载
    function waitImagesLoadedDemo1(images, callback) {
      let loadedCount = 0;
      const total = images.length;
      function checkDone() {
        loadedCount++;
        if (loadedCount >= total) {
          callback();
        }
      }
      images.forEach((img) => {
        if (img.complete) {
          checkDone();
        } else {
          img.addEventListener("load", checkDone);
          img.addEventListener("error", checkDone);
        }
      });
      if (total === 0) callback();
    }

    function initdemo1CarouselTrack() {
      const container = document.querySelector(".demo1-carousel-container");
      const track = document.querySelector(".demo1-carousel-track");
      let slides = Array.from(document.querySelectorAll(".demo1-carousel-slide"));
      const prevBtn = document.querySelector(".demo1-carousel-prev");
      const nextBtn = document.querySelector(".demo1-carousel-next");
      const dots = Array.from(document.querySelectorAll(".demo1-carousel-dot"));

      if (!container || !track || slides.length === 0 || dots.length === 0) return;

      const totalReal = slides.length;
      let isAnimating = false;
      let currentIndex = 1;
      let slideWidth = 0;
      let gapWidth = 0;

      // ========== 1) 克隆首尾幻灯片 ==========
      const firstClone = slides[0].cloneNode(true);
      const lastClone = slides[totalReal - 1].cloneNode(true);
      track.appendChild(firstClone);
      track.insertBefore(lastClone, track.firstChild);

      slides = Array.from(track.querySelectorAll(".demo1-carousel-slide"));

      // ========== 2) 计算宽度 & transform 偏移 ==========
      function updateSlideWidth() {
        if (window.innerWidth <= 768) {
          const containerWidth = container.offsetWidth;
          gapWidth = containerWidth * 0.04;
          slides.forEach((slide) => {
            slide.style.width = `${containerWidth * 0.75}px`;
          });
          slideWidth = containerWidth * 0.75 + gapWidth;
        } else {
          slides.forEach((slide) => {
            slide.style.width = "";
          });
          gapWidth = 15;
          slideWidth = slides[1].getBoundingClientRect().width + gapWidth;
        }
      }

      // ========== 3) 更新轮播状态：左右可见部分对称处理 ==========
      function updateCarousel(animated = true) {
        updateSlideWidth();
        track.style.transition = animated ? "transform 0.5s ease-in-out" : "none";

        if (window.innerWidth <= 768) {
          track.style.transform = `translateX(${-currentIndex * slideWidth + gapWidth / 2}px)`;
        } else {
          track.style.transform = `translateX(${-currentIndex * slideWidth}px)`;
        }

        let dotIndex =
          currentIndex === 0
            ? totalReal - 1
            : currentIndex === slides.length - 1
            ? 0
            : currentIndex - 1;
        dots.forEach((dot, i) => dot.classList.toggle("active", i === dotIndex));

        slides.forEach((sl) => sl.classList.remove("active", "prev", "next", "shadow"));
        slides[currentIndex].classList.add("active");

        const nextIndex = (currentIndex + 1) % slides.length;
        const prevIndex = (currentIndex - 1 + slides.length) % slides.length;
        slides[nextIndex].classList.add("next");
        slides[prevIndex].classList.add("prev");

        slides.forEach((slide) => {
          if (!slide.classList.contains("active")) {
            slide.classList.add("shadow");
          }
        });

        slides.forEach((slide) => {
          const link = slide.querySelector("a");
          if (link) {
            link.style.pointerEvents = slide.classList.contains("active") ? "auto" : "none";
          }
        });

        document.querySelectorAll(".demo1-explore-btn").forEach((btn) => {
          btn.style.opacity = "0";
          btn.style.pointerEvents = "none";
        });
        const activeBtn = slides[currentIndex].querySelector(".demo1-explore-btn");
        if (activeBtn) {
          activeBtn.style.opacity = "1";
          activeBtn.style.pointerEvents = "auto";
        }
      }

      // ========== 4) 切换函数 ==========
      function nextSlide() {
        if (isAnimating) return;
        isAnimating = true;
        currentIndex++;
        updateCarousel();
        setTimeout(() => {
          if (currentIndex === slides.length - 1) {
            track.style.transition = "none";
            currentIndex = 1;
            updateCarousel(false);
          }
          isAnimating = false;
        }, 500);
      }

      function prevSlide() {
        if (isAnimating) return;
        isAnimating = true;
        currentIndex--;
        updateCarousel();
        setTimeout(() => {
          if (currentIndex === 0) {
            track.style.transition = "none";
            currentIndex = slides.length - 2;
            updateCarousel(false);
          }
          isAnimating = false;
        }, 500);
      }

      function jumpToSlide(index) {
        if (isAnimating) return;
        isAnimating = true;
        currentIndex = index + 1;
        updateCarousel();
        setTimeout(() => {
          isAnimating = false;
        }, 500);
      }

      // ========== 5) 自动播放 ==========
      let interval = setInterval(nextSlide, 5000);
      function resetInterval() {
        clearInterval(interval);
        interval = setInterval(nextSlide, 5000);
      }

      // ========== 6) 点击事件绑定 ==========
      prevBtn?.addEventListener("click", (e) => {
        e.stopPropagation();
        prevSlide();
        resetInterval();
      });
      nextBtn?.addEventListener("click", (e) => {
        e.stopPropagation();
        nextSlide();
        resetInterval();
      });

      dots.forEach((dot, i) => {
        dot.addEventListener("click", (e) => {
          e.stopPropagation();
          jumpToSlide(i);
          resetInterval();
        });
      });

      slides.forEach((slide) => {
        slide.addEventListener("click", (e) => {
          if (slide.classList.contains("active")) {
            return;
          } else if (slide.classList.contains("next")) {
            e.preventDefault();
            nextSlide();
            resetInterval();
          } else if (slide.classList.contains("prev")) {
            e.preventDefault();
            prevSlide();
            resetInterval();
          }
        });

        // 若有 .demo1-explore-btn，则阻止冒泡，确保可点
        const exploreBtn = slide.querySelector(".demo1-explore-btn");
        if (exploreBtn) {
          exploreBtn.addEventListener("click", (ev) => {
            ev.stopPropagation();
          });
        }
      });

      // ========== 8) 手机端触摸滑动更灵敏(阈值=20px) ==========
      let startX = 0;
      let isSwiping = false;
      track.addEventListener(
        "touchstart",
        (e) => {
          if (e.touches.length === 1) {
            startX = e.touches[0].clientX;
            isSwiping = true;
          }
        },
        { passive: true }
      );
      track.addEventListener("touchmove", () => {}, { passive: true });
      track.addEventListener(
        "touchend",
        (e) => {
          if (!isSwiping) return;
          isSwiping = false;
          const endX = e.changedTouches[0].clientX;
          const diff = endX - startX;
          // 20px阈值 => 更容易触发
          if (Math.abs(diff) > 20) {
            if (diff < 0) {
              nextSlide();
            } else {
              prevSlide();
            }
            resetInterval();
          }
        },
        { passive: true }
      );

      // ========== 8) 初始化 + 监听窗口变化 ==========
      window.addEventListener("resize", updateCarousel);

      track.style.transition = "none";
      updateCarousel(false);
      setTimeout(() => {
        track.style.transition = "transform 0.5s ease-in-out";
      }, 50);

      if (window.innerWidth <= 768) {
        prevBtn.style.display = "block";
        nextBtn.style.display = "block";
      } else {
        prevBtn.style.display = "none";
        nextBtn.style.display = "none";
      }

      track.addEventListener("transitionend", () => {
        isAnimating = false;
      });
    }

    // 等待图片加载完再初始化
    const slideImgs = Array.from(document.querySelectorAll(".demo1-carousel-slide img"));
    waitImagesLoadedDemo1(slideImgs, () => {
      initdemo1CarouselTrack();
    });
  })();




(function(){
  // 1) 获取 natural2 容器 & 等图加载
  const container = document.querySelector(".natural2-carousel-container");
  if(!container) return;

  container.style.visibility = "hidden";
  const track = container.querySelector(".natural2-carousel-track");
  let slides = track ? Array.from(track.querySelectorAll(".natural2-carousel-slide")) : [];
  if(!track || !slides.length){
    console.warn("[natural2] container/track/slides not found!");
    return;
  }

  const prevBtn = document.querySelector(".natural2-carousel-prev");
  const nextBtn = document.querySelector(".natural2-carousel-next");
  const dots    = Array.from(document.querySelectorAll(".natural2-carousel-dot"));

  // 收集所有图
  const allImgs= Array.from(track.querySelectorAll("img"));
  waitImagesLoadedNatural2(allImgs, ()=>{
    container.style.visibility= "visible";
    const isMobile= (window.innerWidth<=768);
    if(isMobile){
      initSnapCarouselMobile_N2(); // 移动端 => 不变
    } else {
      initSnapCarouselDesktopOptimized_N2(); // 桌面端 => 新函数名
    }
  });

  // 等图片加载
  function waitImagesLoadedNatural2(images, callback){
    let loaded=0;
    const total= images.length;
    if(!total){
      callback();
      return;
    }
    images.forEach(img=>{
      if(img.complete){
        checkDone();
      } else {
        img.addEventListener("load", checkDone);
        img.addEventListener("error", checkDone);
      }
    });
    function checkDone(){
      loaded++;
      if(loaded>= total){
        callback();
      }
    }
  }

  // ============== 移动端 => 自动滚动播放集成 ==============
function initSnapCarouselMobile_N2(){
  console.log("[natural2-mobile] auto-play mobile logic.");
  const totalReal = slides.length;

  // 1) 首尾克隆
  const firstClone = slides[0].cloneNode(true);
  const lastClone  = slides[slides.length -1].cloneNode(true);
  track.appendChild(firstClone);
  track.insertBefore(lastClone, slides[0]);
  slides = Array.from(track.querySelectorAll(".natural2-carousel-slide"));

  // 当前索引 => 1 (第一张真实)
  let currentIndex = 1;
  let scrollTimer  = null; // scroll事件防抖
  let autoTimer    = null; // —— 新增：自动播放定时器
  const autoplayInterval = 5000; // —— 新增：5秒自动切换

  // 2) 基本 scroll-snap 设置
  container.style.overflowX      = "auto";
  container.style.scrollSnapType = "x mandatory"; // or proximity
  container.style.scrollBehavior = "smooth";       // 只能调大/小 很有限

  slides.forEach(sl=>{
    sl.style.scrollSnapAlign = "center";
    // sl.style.display        = "inline-block"; // 需要则加
    // sl.style.width          = "..."           // 需要则加
  });

  // 3) setInitialPos => 若可见 => 滚到 index=1
  function setInitialPos(){
    if(isInViewport(container)){
      track.style.scrollBehavior="auto";
      slides[1].scrollIntoView({ behavior:"auto", block:"nearest", inline:"center" });
      track.style.scrollBehavior="smooth";
    }
  }
  setInitialPos();

  // 4) 获取活跃slide => 距容器中心最近
  function getActiveIndex(){
    const cRect  = container.getBoundingClientRect();
    const cCenter= cRect.left + cRect.width/2;
    let minDiff= Infinity, foundI=1;
    slides.forEach((sl,i)=>{
      const r= sl.getBoundingClientRect();
      const sCenter= r.left + r.width/2;
      const diff= Math.abs(sCenter- cCenter);
      if(diff< minDiff){
        minDiff= diff;
        foundI= i;
      }
    });
    return foundI;
  }

  // 5) updateClasses => active, dots
  function updateClasses(){
    const actI= getActiveIndex();
    slides.forEach(s => s.classList.remove("active","prev","next","shadow"));
    slides[actI]?.classList.add("active");
    const nextI= (actI+1)% slides.length;
    const prevI= (actI-1+ slides.length)% slides.length;
    slides[nextI]?.classList.add("next");
    slides[prevI]?.classList.add("prev");
    slides.forEach(s=>{
      if(!s.classList.contains("active")){
        s.classList.add("shadow");
      }
    });
    // dots => 0 => totalReal-1, last => 0
    let dotIndex;
    if(actI===0){
      dotIndex= totalReal-1;
    } else if(actI=== slides.length-1){
      dotIndex=0;
    } else {
      dotIndex= actI-1;
    }
    dots.forEach((d,i)=> d.classList.toggle("active", i===dotIndex));
  }

  // 6) fixCloneIndex => 若在[0]或末尾 => 无动画回到中间(1或 totalReal)
  function fixCloneIndex(){
    const actI= getActiveIndex();
    if(actI===0){
      if(isInViewport(container)){
        currentIndex= totalReal;
        track.style.scrollBehavior="auto";
        slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center" });
        track.style.scrollBehavior="smooth";
      } else {
        currentIndex= totalReal;
      }
    } else if(actI=== slides.length -1){
      if(isInViewport(container)){
        currentIndex=1;
        track.style.scrollBehavior="auto";
        slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center" });
        track.style.scrollBehavior="smooth";
      } else {
        currentIndex=1;
      }
    } else {
      currentIndex= actI;
    }
    updateClasses();
  }

  // 7) scroll => 防抖 => fixCloneIndex
  track.addEventListener("scroll",()=>{
    if(scrollTimer) clearTimeout(scrollTimer);
    scrollTimer= setTimeout(()=>{
      fixCloneIndex();
      updateClasses();
    },150);
  });

  // —— 新增：切换函数（与原版 next/prevSlide 位置对齐） —— 
  function nextSlide(){
    if(!isInViewport(container)){
      stopAuto();
      return;
    }
    if(currentIndex=== slides.length-2){
      track.style.scrollBehavior="auto";
      currentIndex= 1;
      slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center" });
      track.style.scrollBehavior="smooth";
    } else {
      currentIndex++;
      scrollToIndex(currentIndex,true);
    }
  }
  function prevSlide(){
    if(!isInViewport(container)){
      stopAuto();
      return;
    }
    if(currentIndex===1){
      track.style.scrollBehavior="auto";
      currentIndex= totalReal;
      slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center" });
      track.style.scrollBehavior="smooth";
    } else {
      currentIndex--;
      scrollToIndex(currentIndex,true);
    }
  }
  function scrollToIndex(i, smooth=true){
    if(i<0) i=0;
    if(i>= slides.length) i= slides.length-1;
    const target= slides[i];
    if(!target) return;
    if(isInViewport(container)){
      track.style.scrollBehavior= smooth?"smooth":"auto";
      target.scrollIntoView({ 
        behavior: smooth?"smooth":"auto",
        block:"nearest",
        inline:"center"
      });
    } else {
      currentIndex= i;
    }
    updateClasses();
  }

  // —— 新增：自动播放控制 —— 
  function startAuto(){
    if(!autoTimer){
      autoTimer = setInterval(nextSlide, autoplayInterval);
    }
  }
  function stopAuto(){
    clearInterval(autoTimer);
    autoTimer = null;
  }
  function resetAutoTimer(){
    stopAuto();
    startAuto();
  }

  // 9) 按钮 & dots & slide点击
  prevBtn?.addEventListener("click",(e)=>{
    e.stopPropagation();
    prevSlide();
    resetAutoTimer();
  });
  nextBtn?.addEventListener("click",(e)=>{
    e.stopPropagation();
    nextSlide();
    resetAutoTimer();
  });
  dots.forEach((dot,i)=>{
    dot.addEventListener("click",(e)=>{
      e.stopPropagation();
      currentIndex= i+1;
      scrollToIndex(currentIndex,true);
      resetAutoTimer();
    });
  });
  slides.forEach((slide)=>{
    slide.addEventListener("click",(e)=>{
      if(slide.classList.contains("active")){
        // do nothing
      } else if(slide.classList.contains("next")){
        e.preventDefault();
        nextSlide();
        resetAutoTimer();
      } else if(slide.classList.contains("prev")){
        e.preventDefault();
        prevSlide();
        resetAutoTimer();
      }
    });
    const exploreBtn= slide.querySelector(".natural2-explore-btn");
    if(exploreBtn){
      exploreBtn.addEventListener("click",(ev)=> ev.stopPropagation());
    }
  });

  // 10) 手动滑动 => 暂停 => 3s后重启(若可见)
  track.addEventListener("touchstart",(e)=>{
    stopAuto();
  });
  track.addEventListener("touchend",(e)=>{
    setTimeout(()=>{
      if(isInViewport(container) && !autoTimer){
        startAuto();
      }
    },3000);
  });

  // 11) 恢复空白 => visibilitychange / pageshow
  document.addEventListener("visibilitychange", handleVisibilityChange);
  window.addEventListener("pageshow", handlePageShow);
  function handleVisibilityChange() {
    if (!document.hidden) {
      if (!autoTimer && isInViewport(container)) {
        startAuto();
      }
      if (isInViewport(container)) {
        fixCloneIndex();
        updateClasses();
        track.style.scrollBehavior = "auto";
        slides[currentIndex].scrollIntoView({ behavior: "auto", inline: "center", block: "nearest" });
        track.style.scrollBehavior = "smooth";
      }
    } else {
      stopAuto();
    }
  }
  function handlePageShow(e) {
    if (e.persisted) {
      if (isInViewport(container)) {
        fixCloneIndex();
        updateClasses();
        track.style.scrollBehavior = "auto";
        slides[currentIndex].scrollIntoView({ behavior: "auto", inline: "center", block: "nearest" });
        track.style.scrollBehavior = "smooth";
      }
    }
  }

  // —— 新增：可见即自动播放，不可见暂停 —— 
  const obs = new IntersectionObserver(entries=>{
    entries.forEach(entry=>{
      if(entry.isIntersecting){
        startAuto();
      } else {
        stopAuto();
      }
    });
  },{ threshold: 0.5 });
  obs.observe(container);

  // 12) init
  function init(){
    track.style.scrollBehavior="auto";
    scrollToIndex(currentIndex,false);
    track.style.scrollBehavior="smooth";
    updateClasses();
    startAuto(); // —— 新增：初始化时启动自动播放
  }
  init();

  window.addEventListener("resize", ()=>{
    fixCloneIndex();
    updateClasses();
  });
}


  // ============== 桌面端 => 优化 => 仅当可视区 => auto-play, etc ==============
function initSnapCarouselDesktopOptimized_N2(){
  console.log("[natural2-desktop] scroll-snap + clone + observer => no jump, N2.");
  const container = document.querySelector(".natural2-carousel-container");
  const track     = container.querySelector(".natural2-carousel-track");
  let slides      = Array.from(track.querySelectorAll(".natural2-carousel-slide"));
  if(!slides.length){
    console.warn("[natural2-desktop] no slides found!");
    return;
  }

  const prevBtn = document.querySelector(".natural2-carousel-prev");
  const nextBtn = document.querySelector(".natural2-carousel-next");
  const dots    = Array.from(document.querySelectorAll(".natural2-carousel-dot"));

  // A) 首尾克隆
  const totalReal= slides.length;
  const firstClone= slides[0].cloneNode(true);
  const lastClone = slides[slides.length-1].cloneNode(true);
  track.appendChild(firstClone);
  track.insertBefore(lastClone, slides[0]);
  slides= Array.from(track.querySelectorAll(".natural2-carousel-slide"));

  // B) 当前索引=1 => 第一张真实
  let currentIndex= 1;
  let scrollTimer= null;
  let autoTimer= null; // 自动播放定时器

  // C) scroll-snap
  container.style.overflowX      = "auto";
  container.style.scrollSnapType = "x mandatory";
  container.style.scrollBehavior = "smooth";

  slides.forEach(sl=>{
    sl.style.scrollSnapAlign= "center";
    // 其他 CSS 视需
  });

  // D) setInitialPos => 若在视口则滚到 index=1
  function setInitialPos(){
    if(isInViewport(container)){
      track.style.scrollBehavior="auto";
      slides[1].scrollIntoView({ behavior:"auto", block:"nearest", inline:"center"});
      track.style.scrollBehavior="smooth";
    }
  }
  setInitialPos();

  // E) 找到最活跃slide => 距容器中心最近
  function getActiveIndex(){
    const cRect= container.getBoundingClientRect();
    const cCenter= cRect.left + cRect.width/2;
    let minDiff= Infinity, foundI=1;
    slides.forEach((sl,i)=>{
      const r= sl.getBoundingClientRect();
      const sCenter= r.left + r.width/2;
      const diff= Math.abs(sCenter- cCenter);
      if(diff< minDiff){
        minDiff= diff;
        foundI= i;
      }
    });
    return foundI;
  }

  // F) updateClasses => active, next, prev, dots
  function updateClasses(){
    const actI= getActiveIndex();
    slides.forEach(s=> s.classList.remove("active","prev","next","shadow"));
    slides[actI]?.classList.add("active");
    const nextI= (actI+1)%slides.length;
    const prevI= (actI-1+ slides.length)% slides.length;
    slides[nextI]?.classList.add("next");
    slides[prevI]?.classList.add("prev");
    slides.forEach(s=>{
      if(!s.classList.contains("active")){
        s.classList.add("shadow");
      }
    });
    // dots => 0 => totalReal-1, last => 0
    let dotIndex;
    if(actI===0){
      dotIndex= totalReal-1;
    } else if(actI=== slides.length-1){
      dotIndex=0;
    } else {
      dotIndex= actI-1;
    }
    dots.forEach((d,i)=>{
      d.classList.toggle("active", i=== dotIndex);
    });
  }

  // G) fixCloneIndex => 若 actI=0 => 跳到 totalReal, actI=slides.length-1 => 跳到1
  function fixCloneIndex(){
    const actI= getActiveIndex();
    if(actI===0){
      if(isInViewport(container)){
        currentIndex= totalReal;
        track.style.scrollBehavior="auto";
        slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center"});
        track.style.scrollBehavior="smooth";
      } else {
        currentIndex= totalReal;
      }
    } else if(actI=== slides.length-1){
      if(isInViewport(container)){
        currentIndex=1;
        track.style.scrollBehavior="auto";
        slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center"});
        track.style.scrollBehavior="smooth";
      } else {
        currentIndex=1;
      }
    } else {
      currentIndex= actI;
    }
    updateClasses();
  }

  // H) scroll => 防抖 => fixCloneIndex
  track.addEventListener("scroll",()=>{
    if(scrollTimer) clearTimeout(scrollTimer);
    scrollTimer= setTimeout(()=>{
      fixCloneIndex();
      updateClasses();
    },150);
  });

  // I) autoTimer => only +1 => no skip
  let autoplayInterval= 5000;
  // 先不立即开启 => 由 intersection observer 来决定何时开启
  // autoTimer= setInterval(nextSlide, autoplayInterval);

  function nextSlide(){
    if(!isInViewport(container)){
      stopAutoTimer();
      return;
    }
    if(currentIndex=== slides.length-2){
      // 到最后真实 => 回到1
      track.style.scrollBehavior="auto";
      currentIndex=1;
      slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center"});
      track.style.scrollBehavior="smooth";
    } else {
      currentIndex++;
      scrollToIndex(currentIndex,true);
    }
  }
  function prevSlide(){
    if(!isInViewport(container)){
      stopAutoTimer();
      return;
    }
    if(currentIndex===1){
      track.style.scrollBehavior="auto";
      currentIndex= totalReal;
      slides[currentIndex].scrollIntoView({ block:"nearest", inline:"center"});
      track.style.scrollBehavior="smooth";
    } else {
      currentIndex--;
      scrollToIndex(currentIndex,true);
    }
  }
  function scrollToIndex(i, smooth=true){
    if(i<0) i=0;
    if(i>= slides.length) i= slides.length-1;
    const target= slides[i];
    if(!target) return;
    if(isInViewport(container)){
      track.style.scrollBehavior= smooth?"smooth":"auto";
      target.scrollIntoView({
        behavior: smooth?"smooth":"auto",
        block:"nearest",
        inline:"center"
      });
    } else {
      currentIndex= i;
    }
  }
  function stopAutoTimer(){
    clearInterval(autoTimer);
    autoTimer= null;
  }
  function startAutoTimer(){
    if(!autoTimer){
      autoTimer= setInterval(nextSlide, autoplayInterval);
    }
  }
  function resetAutoTimer(){
    stopAutoTimer();
    startAutoTimer();
  }

  // J) 按钮 / dots
  prevBtn?.addEventListener("click",(e)=>{
    e.stopPropagation();
    prevSlide();
    resetAutoTimer();
  });
  nextBtn?.addEventListener("click",(e)=>{
    e.stopPropagation();
    nextSlide();
    resetAutoTimer();
  });
  dots.forEach((dot,i)=>{
    dot.addEventListener("click",(e)=>{
      e.stopPropagation();
      currentIndex= i+1;
      scrollToIndex(currentIndex,true);
      resetAutoTimer();
    });
  });
  slides.forEach((slide)=>{
    slide.addEventListener("click",(e)=>{
      if(slide.classList.contains("active")){
        // do nothing
      } else if(slide.classList.contains("next")){
        e.preventDefault();
        nextSlide();
        resetAutoTimer();
      } else if(slide.classList.contains("prev")){
        e.preventDefault();
        prevSlide();
        resetAutoTimer();
      }
    });
    const exploreBtn= slide.querySelector(".natural2-explore-btn");
    if(exploreBtn){
      exploreBtn.addEventListener("click",(ev)=> ev.stopPropagation());
    }
  });

  // K) visibilitychange/pageshow => 不跳页
  document.addEventListener("visibilitychange", handleVisibilityChange);
  window.addEventListener("pageshow", handlePageShow);

  function handleVisibilityChange(){
    if(!document.hidden){
      // 回到前台 => 修正索引，但仅在轮播区域在可视区时才滚动
      fixCloneIndex();
      
      // 若没有自动播放且容器在视口 -> 开启
      if(!autoTimer && isInViewport(container)){
        startAutoTimer();
      }
      // ★ 如果不在可视区 -> 不滚动
      if(isInViewport(container)){
        track.style.scrollBehavior="auto";
        slides[currentIndex].scrollIntoView({ behavior:"auto", block:"nearest", inline:"center"});
        track.style.scrollBehavior="smooth";
      }
    } else {
      // 离开 => stop
      stopAutoTimer();
    }
  }

  function handlePageShow(e){
    if(e.persisted){
      // 走 bfcache
      // 同样，修正索引，但只有当容器在视口中时才强制滚动
      fixCloneIndex();
      if(isInViewport(container)){
        track.style.scrollBehavior="auto";
        slides[currentIndex].scrollIntoView({ behavior:"auto", block:"nearest", inline:"center"});
        track.style.scrollBehavior="smooth";
      }
    }
  }

  // L) IntersectionObserver => 当用户划到 natural2 区域 => start auto
  const observer = new IntersectionObserver((entries)=>{
    entries.forEach(entry=>{
      if(entry.isIntersecting){
        startAutoTimer();
      } else {
        stopAutoTimer();
      }
    });
  }, { threshold: 0.1 }); 
  observer.observe(container);

  // M) 初始化
  function init(){
    track.style.scrollBehavior="auto";
    scrollToIndex(currentIndex,false);
    track.style.scrollBehavior="smooth";
    updateClasses();
  }
  init();

  window.addEventListener("resize", ()=>{
    fixCloneIndex();
    updateClasses();
  });
}

/** ============== isInViewport ============== **/
function isInViewport(elem){
  if(!elem) return false;
  const rect= elem.getBoundingClientRect();
  return (rect.top< window.innerHeight && rect.bottom>=0);
}


/**
 * ============== 新增示例函数: isCenteredInViewport ==============
 * 如果你想更严格地判断 natural2 容器是否“居中或附近”，
 * 可以定义一个阈值，比如上下100px都视为“附近”。
 */
function isCenteredInViewport(elem){
  if(!elem) return false;
  const rect = elem.getBoundingClientRect();
  const windowHeight = window.innerHeight;
  // 计算容器的垂直中点
  const containerCenter = rect.top + rect.height / 2;
  // 浏览器视口中点
  const viewportCenter  = windowHeight / 2;
  // 阈值，例如上下 100 px 都算是“靠近中心”
  const threshold = 100; 
  return Math.abs(containerCenter - viewportCenter) <= threshold;
}

})();


  <!-- ================= 新增：回到顶部功能脚本 ================= -->

    document.addEventListener("DOMContentLoaded", function() {
      const backToTop = document.getElementById("backToTop");
      window.addEventListener("scroll", function() {
        if (window.scrollY > 500) {
          backToTop.style.display = "flex";
        } else {
          backToTop.style.display = "none";
        }
      });
      backToTop.addEventListener("click", function() {
        window.scrollTo({ top: 0, behavior: "smooth" });
      });
    });






</script>
</body>
</html>



     
  




